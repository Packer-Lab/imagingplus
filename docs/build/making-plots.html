
<!DOCTYPE html>

<html lang="en">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Plotting of data and analyses | Imaging+ 0.2-beta documentation</title>
<link href="_static/pygments.css" rel="stylesheet"/>
<link href="_static/theme.9297a650d9dd3016d913.css" rel="stylesheet"/>
<link href="_static/sg_gallery.css" rel="stylesheet"/>
<link href="search.html" rel="search" title="Search"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="reference.html" rel="next" title="API reference"/>
<link href="data-structure-details.html" rel="prev" title="Data Structure Inside Trial objects"/>
</head>
<body class="antialiased text-gray scroll-smooth">
<div class="min-h-screen xl:h-screen flex flex-col xl:grid xl:grid-layout print:block print:h-auto" data-action="keydown@window-&gt;search#focus " data-controller="sidebar search " id="page">
<a class="block transition -translate-x-full focus:translate-x-0 opacity-0 focus:opacity-100 text-xl bg-white p-4 z-20 absolute top-0 left-0 h-14" href="#plotting-of-data-and-analyses" title="Skip navigation links">Skip to content</a>
<header class="grid-area-header z-10 h-14 fixed w-full top-0 print:hidden">
<div class="bg-gray-dark shadow-md flex items-center h-full xl:px-2 relative"><div class="flex items-center">
<button class="xl:hidden h-14 w-14 leading-14 text-gray-100 hover:bg-gray-700 hover:text-brand focus:outline-none focus:bg-gray-700 focus:text-brand" data-action="sidebar#open" data-sidebar-target="hamburger">
<span class="sr-only">Open navigation menu</span>
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
</button><a class="hover:bg-gray-700 focus:bg-gray-700 focus:outline-none" href="index.html" title="Back to homepage"><img alt="Logo" class="h-14 w-14 p-3 inline-block" src="_static/imagingplus-logo.png"/><span class="hidden lg:inline-block shrink-0 font-medium text-gray-100 mx-5 leading-14 tracking-wider">Imaging+ 0.2-beta documentation</span>
</a></div><div class="flex justify-end items-center flex-1"><form action="search.html" class="flex print:hidden justify-between items-center leading-14 md:ml-4 bg-gray-dark text-gray-300 focus-within:bg-gray-50 focus-within:text-gray-800 focus-within:absolute focus-within:inset-x-0 focus-within:top-0 md:focus-within:w-full md:focus-within:static z-10" data-action="click-&gt;search#focusSearchInput" id="searchbox" method="get">
<button aria-label="Get search results" class="text-inherit h-14 w-14" tabindex="-1">
<svg aria-hidden="true" class="fill-current stroke-current h-8 w-8" stroke-width="0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
<input aria-label="Search the docs" class="pr-2 bg-transparent text-inherit focus:outline-none w-0 md:w-auto focus:w-full transition-all duration-100" data-search-target="searchInput" id="search-input" name="q" placeholder="Search the docs" type="search"/>
</form></div>
</div>
</header>
<aside class="grid-area-sidebar h-full fixed pt-14 xl:relative inset-y-0 left-0 z-20 xl:z-0 print:hidden overflow-y-auto transition-all transform transform-gpu -translate-x-full opacity-0 duration-300 xl:translate-x-0 xl:opacity-100" data-sidebar-target="sidebar">
<nav class="h-full overflow-y-auto bg-white text-gray-600 pt-8 flex flex-col" role="navigation">
<div class="nav-toc flex-1 pl-6"><ul class="current">
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="installation.html">Installation</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="installation.html#installation">Installation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="installation.html#test-import-installation">Test/Import Installation</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="installation.html#dependencies">Dependencies</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="installation.html#next">Next</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="quick-start-guide.html">Quick start guide</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="quick-start-guide.html#key-structures">Key Structures</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="quick-start-guide.html#next">Next</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="overview.html">Overview</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="overview.html#modular-data-processing-analysis-and-visualisation"><strong>Modular Data Processing, Analysis and Visualisation</strong></a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="overview.html#extensibility"><strong>Extensibility</strong></a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="overview.html#next">Next</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials-reference.html">Tutorials</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-1-Overview-of-Workflow.html">Tutorial 1 - Getting started with data</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-1-Overview-of-Workflow.html#Creating-an-experiment">Creating an experiment</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-1-Overview-of-Workflow.html#Adding-trials-to-an-experiment">Adding trials to an experiment</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-1-Overview-of-Workflow.html#Adding-calcium-imaging-processing-to-Experiment">Adding calcium imaging processing to Experiment</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-1-Overview-of-Workflow.html#Storing-Suite2p-processed-data-as-an-anndata-structure">Storing Suite2p processed data as an anndata structure</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-2-Organization-of-data-in-package-objects.html">Tutorial 2 - Data organization inside imaging+</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-2-Organization-of-data-in-package-objects.html#Importing-data-analysis-objects">Importing data analysis objects</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-2-Organization-of-data-in-package-objects.html#paq-data">paq data</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-2-Organization-of-data-in-package-objects.html#Annotated-Data">Annotated Data</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-3-plotting-module.html">Tutorial 3 - Making Useful Plots</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-3-plotting-module.html#plot-Suite2p-ROIs-location">plot Suite2p ROIs location</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-3-plotting-module.html#plot-default-output-images-from-Suite2p">plot default output images from Suite2p</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-3-plotting-module.html#plot-individual-cell’s-flu-or-dFF-trace">plot individual cell’s flu or dFF trace</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-3-plotting-module.html#Raw-average-trace-of-FOV">Raw average trace of FOV</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-4-nwb-conversion.html">Tutorial 4 - NWB Conversion</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html">Tutorial 5 - Integrating with Suite2p (running Suite2p pipeline and storing results)</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html#Adding-the-Suite2p-module">Adding the Suite2p module</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html#Prepare-for-Suite2p-run">Prepare for Suite2p run</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html#Run-Suite2p">Run Suite2p</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html#Explore-suite2p-results---next-steps-after-running-Suite2p">Explore suite2p results - next steps after running Suite2p</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-5-suite2p-module.html#Import-suite2p-results-directly">Import suite2p results directly</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-6-anndata-module.html">Tutorial 6 - Annotated Data Module</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-6-anndata-module.html#storage-of-Flu-data">storage of Flu data</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-6-anndata-module.html#observations-(Suite2p-ROIs-metadata-and-associated-processing-info)">observations (Suite2p ROIs metadata and associated processing info)</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-6-anndata-module.html#variables-(temporal-synchronization-of-paq-channels-and-imaging)">variables (temporal synchronization of paq channels and imaging)</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-7-paq-module.html">Tutorial 7 - Integration with PACKIO outputs (.paq data)</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-7-paq-module.html#adding-paqdata-module-to-the-trialobj">adding paqdata module to the trialobj</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-7-paq-module.html#Processing-paq-data">Processing paq data</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-7-paq-module.html#Synchronizing-.paq-data-with-imaging-frames">Synchronizing .paq data with imaging frames</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-8-Extending-built-in-classes.html">Tutorial 8 - Extending built in classes</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="Tutorials/Tutorial-8-Extending-built-in-classes.html#Creating-a-custom-class-for-Interneuron-Gcamp-imaging-during-seizures">Creating a custom class for Interneuron Gcamp imaging during seizures</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html">Main Modules</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html#main">Main</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html#processing">Processing</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html#workflow">Workflow</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html#utils">Utils</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="organization-of-modules.html#plotting">Plotting</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="data-structure-details.html">Data structure details</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="data-structure-details.html#anndata-object-for-storing-multi-modal-data"><em>AnnData</em> object for storing multi-modal data</a></div></li>
</ul>
</li>
<li class="toctree-l1 current expanded"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="current reference internal" data-action="click-&gt;sidebar#close" href="#">Making plots</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="#module-imagingplus.plotting.plotting">Available plotting functions:</a></div></li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html">API Reference</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#module-imagingplus.main.core">core</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#module-imagingplus.main.subcore">subcore</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#module-imagingplus.plotting.plotting">plotting</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#module-imagingplus.processing.anndata">processing</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#workflows-alloptical">workflows (AllOptical)</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="reference.html#module-imagingplus.utils.io">utils</a></div></li>
</ul>
</li>
</ul>
</div>
<button class="text-4xl text-gray-800 p-4 bottom-0 hover:text-brand xl:hidden focus:text-brand self-center" data-action="sidebar#close" title="Close navigation menu">
<span class="sr-only">Close navigation menu</span>
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</aside>
<main class="px-4 pt-14 xl:ml-fluid grid-area-main overflow-y-auto flex flex-col flex-1 h-full mx-0 md:mx-auto xl:mr-0"><nav aria-label="breadcrumbs" class="print:hidden mt-12 text-sm text-gray-light" role="navigation">
<a class="text-gray-light text-sm hover:text-gray-dark font-medium focus:text-gray-dark" href="index.html">Imaging+ 0.2-beta documentation</a>
<span class="mr-1">/</span><span aria-current="page">Plotting of data and analyses</span>
</nav>
<article class="flex-1" role="main">
<section id="plotting-of-data-and-analyses">
<span id="making-plots"></span><h1>Plotting of data and analyses<a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#plotting-of-data-and-analyses">¶</a></h1>
<p><code class="docutils literal notranslate">packerlabimaging</code> provides a number of convenience plotting functions to create the most commonly made plots for 2photon imaging analysis.</p>
<p>All of these pre-built plots are demo’ed in a tutorial in <a class="reference internal" href="Tutorials-reference.html#tutorials"><span class="std std-ref">Tutorials</span></a>.</p>
<section id="module-imagingplus.plotting.plotting">
<span id="available-plotting-functions"></span><h2>Available plotting functions:<a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#module-imagingplus.plotting.plotting">¶</a></h2>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plotImg">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plotImg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img</span><span class="p">:</span><span class="w"> </span><span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plotImg"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plotImg">¶</a></dt>
<dd>
<p>Plot image in grayscale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – input image to show</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">trialobj</dt>
<dd class="field-odd"><p>ImagingTrial or SingleImage; object associated with input image.</p>
</dd>
<dt class="field-even">scalebar_um</dt>
<dd class="field-even"><p>int; size of scalebar to plot on image (in um); must provide trialobj parameter.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plotRoiLocations">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plotRoiLocations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n">imagingplus.workflows.TwoPhotonImaging.TwoPhotonImaging</span></em>, <em class="sig-param"><span class="n">suite2p_rois</span><span class="p">:</span><span class="w"> </span><span class="n">Union<span class="p">[</span>list<span class="p">,</span><span class="w"> </span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">background</span><span class="p">:</span><span class="w"> </span><span class="n">numpy.ndarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plotRoiLocations"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plotRoiLocations">¶</a></dt>
<dd>
<p>plots an image of the FOV to show the locations of cells given in cells ls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trialobj</strong> – alloptical or 2p imaging object</p></li>
<li><p><strong>background</strong> – either 2dim numpy array to use as the backsplash or None (default; which is a black background)</p></li>
<li><p><strong>suite2p_rois</strong> – list of ROIs (suite2p cell IDs) to show coord location, default is ‘all’ (which is all ROIs)</p></li>
<li><p><strong>edgecolor</strong> – specify edgecolor of the scatter plot for cells</p></li>
<li><p><strong>facecolor</strong> – specify facecolor of the scatter plot for cells</p></li>
<li><p><strong>cells</strong> – list of cells to plot</p></li>
<li><p><strong>title</strong> – title for plot</p></li>
<li><p><strong>color_float_list</strong> – if given, it will be used to color the cells according a colormap</p></li>
<li><p><strong>cmap</strong> – cmap to be used in conjuction with the color_float_array argument</p></li>
<li><p><strong>show_s2p_targets</strong> – if True, then will prioritize coloring of cell points based on whether they were photostim targets</p></li>
<li><p><strong>invert_y</strong> – if True, invert the reverse the direction of the y axis</p></li>
<li><p><strong>fig</strong> – a matplotlib.Figure instance, if provided use this fig for plotting</p></li>
<li><p><strong>ax</strong> – a matplotlib.Axes.axes instance, if provided use this ax for plotting</p></li>
<li><p><strong>show</strong> – if False, do not display plot (used when the necessity is to return the fig and ax objects to futher manipulation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns fig, ax</dt>
<dd class="field-even"><p>returns fig and ax object, if show is False</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.makeSuite2pPlots">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">makeSuite2pPlots</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span><span class="p">:</span><span class="w"> </span><span class="n">Union<span class="p">[</span><a class="reference internal" href="reference.html#imagingplus.main.core.Experiment" title="imagingplus.main.core.Experiment">imagingplus.main.core.Experiment</a><span class="p">,</span><span class="w"> </span>imagingplus.workflows.TwoPhotonImaging.TwoPhotonImaging<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#makeSuite2pPlots"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.makeSuite2pPlots">¶</a></dt>
<dd>
<p>Makes four plots that are created by Suite2p output.</p>
<p>credit: run_s2p tutorial on Mouseland/Suite2p on github</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – Experiment or Trial object to use for creating Suite2p plots.</p></li>
<li><p><strong>axs</strong> – a matplotlib.Axes.axes instance (4 cols x 1 rows), if provided use these axes for plotting</p></li>
<li><p><strong>show</strong> – if False, do not display plot (used when the necessity is to return the fig and ax objects to futher manipulation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns fig, axs</dt>
<dd class="field-even"><p>returns fig and ax object, if show is False</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_flu_trace">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_flu_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n">imagingplus.workflows.TwoPhotonImaging.TwoPhotonImaging</span></em>, <em class="sig-param"><span class="n">cell</span><span class="p">:</span><span class="w"> </span><span class="n">int</span></em>, <em class="sig-param"><span class="n">to_plot</span><span class="o">=</span><span class="default_value">'raw'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_flu_trace"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_flu_trace">¶</a></dt>
<dd>
<p>Plot individual cell’s flu or dFF trace, with photostim. timings for that cell. Accesses the object’s anndata data storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trialobj</strong> – TwoPhotonImaging (or derived) object containing anndata data storage from which to select cell to plot flu trace</p></li>
<li><p><strong>cell</strong> – cell index number</p></li>
<li><p><strong>to_plot</strong> – select data layer to plot (choose ‘raw’ to plot main raw data layer, otherwise choose name of the desired layer)</p></li>
<li><p><strong>fig</strong> – a matplotlib.Figure instance, if provided use this fig for plotting</p></li>
<li><p><strong>ax</strong> – a matplotlib.Axes.axes instance, if provided use this ax for plotting</p></li>
<li><p><strong>show</strong> – if False, do not display plot (used when the necessity is to return the fig and ax objects to futher manipulation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns fig, ax</dt>
<dd class="field-even"><p>returns fig and ax object, if show is False</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot__channel">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot__channel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tmdata</span><span class="p">:</span><span class="w"> </span><span class="n"><a class="reference internal" href="reference.html#imagingplus.main.subcore.TemporalData" title="imagingplus.main.subcore.TemporalData">imagingplus.main.subcore.TemporalData</a></span></em>, <em class="sig-param"><span class="n">channel</span><span class="p">:</span><span class="w"> </span><span class="n">str</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot__channel"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot__channel">¶</a></dt>
<dd>
<p>Plot the saved signal from the specified channel from a PaqData submodule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmdata</strong> – TemporalData object</p></li>
<li><p><strong>channel</strong> – channel to plot</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">x_axis</dt>
<dd class="field-odd"><p>str; x axis label, if ‘time’ or “Time” found in x_axis label, will convert x axis to time domain.</p>
</dd>
<dt class="field-even">x_tick_secs</dt>
<dd class="field-even"><p>int; interval to plot x axis ticks</p>
</dd>
<dt class="field-odd">ax</dt>
<dd class="field-odd"><p>matplotlib axis object to use for plotting.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.MeanProject">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">MeanProject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frames</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>tuple<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint">numpy.ndarray</span></span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#MeanProject"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.MeanProject">¶</a></dt>
<dd>
<p>Mean Projection function.
Creates, plots and (optionally) saves a Mean Projection image of the loaded tiff. If frames are provided, tiff is cropped to those frames.</p>
<p>Note: saves as 8-bit grayscale image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to tiff file to load (if imstack not provided)</p></li>
<li><p><strong>save_path</strong> – path to save output image</p></li>
<li><p><strong>plot</strong> – if True, show the output image</p></li>
<li><p><strong>imstack</strong> – data stack to use as input (if tiff_path not provided)</p></li>
<li><p><strong>frames</strong> – crop input stack to specified frames before calculating mean projection.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">trialobj</dt>
<dd class="field-odd"><p>ImagingTrial or SingleImage; object associated with input image.</p>
</dd>
<dt class="field-even">scalebar_um</dt>
<dd class="field-even"><p>int; size of scalebar to plot on image (in um); must provide trialobj parameter.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean projection image</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.MaxProject">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">MaxProject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frames</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>tuple<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint">numpy.ndarray</span></span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#MaxProject"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.MaxProject">¶</a></dt>
<dd>
<p>Maximum projection function.
Creates, plots and (optionally) saves an average image of the loaded tiff. If frames are provided, tiff is cropped to those frames.</p>
<p>Note: saves as 8-bit grayscale image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to tiff file to load (if imstack not provided)</p></li>
<li><p><strong>save_path</strong> – path to save output image</p></li>
<li><p><strong>plot</strong> – if True, show the output image</p></li>
<li><p><strong>imstack</strong> – data stack to use as input (if tiff_path not provided)</p></li>
<li><p><strong>frames</strong> – crop input stack to specified frames before calculating maximum projection.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">trialobj</dt>
<dd class="field-odd"><p>ImagingTrial or SingleImage; object associated with input image.</p>
</dd>
<dt class="field-even">scalebar_um</dt>
<dd class="field-even"><p>int; size of scalebar to plot on image (in um); must provide trialobj parameter.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>maximum projection image</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.StdevProject">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">StdevProject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frames</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>tuple<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#StdevProject"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.StdevProject">¶</a></dt>
<dd>
<p>Creates, plots and (optionally) saves an average image of the loaded tiff. If frames are provided, tiff is cropped to those frames.</p>
<p>Note: saves as 8-bit grayscale image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to tiff file to load (if imstack not provided)</p></li>
<li><p><strong>imstack</strong> – data stack to use as input (if tiff_path not provided)</p></li>
<li><p><strong>frames</strong> – crop input stack to specified frames before calculating stdev projection.</p></li>
<li><p><strong>save_path</strong> – path to save output image</p></li>
<li><p><strong>plot</strong> – if True, show the output image</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">trialobj</dt>
<dd class="field-odd"><p>ImagingTrial or SingleImage; object associated with input image.</p>
</dd>
<dt class="field-even">scalebar_um</dt>
<dd class="field-even"><p>int; size of scalebar to plot on image (in um); must provide trialobj parameter.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>stdev projection image</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.InspectTiff">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">InspectTiff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frames</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>tuple<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#InspectTiff"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.InspectTiff">¶</a></dt>
<dd>
<p>Plot stdev, max and mean project of input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to tiff file to load (if imstack not provided)</p></li>
<li><p><strong>imstack</strong> – data stack to use as input (if tiff_path not provided)</p></li>
<li><p><strong>frames</strong> – crop input stack to specified frames before calculating stdev projection.</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">trialobj</dt>
<dd class="field-odd"><p>ImagingTrial or SingleImage; object associated with input image.</p>
</dd>
<dt class="field-even">scalebar_um</dt>
<dd class="field-even"><p>int; size of scalebar to plot on image (in um); must provide trialobj parameter.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.FrameAverage">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">FrameAverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key_frames</span><span class="p">:</span><span class="w"> </span><span class="n">Union<span class="p">[</span>int<span class="p">,</span><span class="w"> </span>list<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peri_frames</span><span class="p">:</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="p">:</span><span class="w"> </span><span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint">numpy.ndarray</span></span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#FrameAverage"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.FrameAverage">¶</a></dt>
<dd>
<p>Creates, plots and/or saves an average image of the specified number of peri-key_frames around the given frame from a multipage imaging TIFF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to tiff file to load (if imstack not provided)</p></li>
<li><p><strong>imstack</strong> – data stack to use as input (if tiff_path not provided)</p></li>
<li><p><strong>key_frames</strong> – key frames around which to create peri-frame averages</p></li>
<li><p><strong>peri_frames</strong> – number of frames around the key frame to calculate average from</p></li>
<li><p><strong>plot</strong> – if True, show the output image</p></li>
<li><p><strong>save_path</strong> – path to save output image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of images</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.SingleFrame">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">SingleFrame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiff_path</span><span class="p">:</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">frame_num</span><span class="p">:</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">imstack</span><span class="p">:</span><span class="w"> </span><span class="n">numpy.array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#SingleFrame"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.SingleFrame">¶</a></dt>
<dd>
<p>plots an image of a single specified tiff frame after reading using tifffile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> – path to .tiff file to loads</p></li>
<li><p><strong>frame_num</strong> – frame # from 2p imaging tiff to show (default is 0 - i.e. the first frame)</p></li>
<li><p><strong>title</strong> – (optional) give a string to use as title</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib imshow plot</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plotMeanFovFluTrace">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plotMeanFovFluTrace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n">imagingplus.workflows.TwoPhotonImaging.TwoPhotonImaging</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plotMeanFovFluTrace"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plotMeanFovFluTrace">¶</a></dt>
<dd>
<p>Make plot of mean fluorescence trace averaged over the whole FOV</p>
<p>NOTE: this function will use the underlying timing that is found under trialobj.tmdata (if that is defined). If there is a mismatch in the number of frame timestamps collected and
the number of imaging frames data, the shorter length will be used for plotting (with no warning printed, as it is often the case that there are dropped frames from the microscope).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trialobj</strong> – TwoPhotonImaging (or derived) object</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">ax</dt>
<dd class="field-odd"><p>matplotlib axis object to use for plotting.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_photostim_traces_overlap">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_photostim_traces_overlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n"><a class="reference internal" href="reference.html#imagingplus.workflows.AllOptical.AllOpticalTrial" title="imagingplus.workflows.AllOptical.AllOpticalTrial">imagingplus.workflows.AllOptical.AllOpticalTrial</a></span></em>, <em class="sig-param"><span class="n">exclude_id</span><span class="p">:</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_spacing_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">x_axis</span><span class="o">=</span><span class="default_value">'Time (seconds)'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_photostim_traces_overlap"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_photostim_traces_overlap">¶</a></dt>
<dd>
<p>Plot fluorescence traces of alloptical stimulated cells on one plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – fluorescence traces of alloptical stimulated cells to plot.</p></li>
<li><p><strong>trialobj</strong> – AllOptical object to select cells from</p></li>
<li><p><strong>exclude_id</strong> – list of cell id’s to exclude from plot</p></li>
<li><p><strong>y_spacing_factor</strong> – increase to add more space between plotted traces</p></li>
<li><p><strong>title</strong> – title of plot</p></li>
<li><p><strong>x_axis</strong> – x-axis of plot in units of Frames or Time (seconds)</p></li>
<li><p><strong>kwargs</strong> – <dl class="field-list simple">
<dt class="field-odd">ax</dt>
<dd class="field-odd"><p>matplotlib axis object to use for plotting.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_periphotostim_avg2">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_periphotostim_avg2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">fps</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">legend_labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">avg_with_std</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">'high quality plot'</span></em>, <em class="sig-param"><span class="n">pre_stim_sec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_periphotostim_avg2"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_periphotostim_avg2">¶</a></dt>
<dd>
<dl class="simple">
<dt>TODO fill documentation and add parameters</dt><dd><dl class="field-list simple">
<dt class="field-odd">param dataset</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param fps</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param legend_labels</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param colors</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param avg_with_std</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param title</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param pre_stim_sec</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param ylim</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param fig</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param ax</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param kwargs</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_periphotostim_avg">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_periphotostim_avg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr</span><span class="p">:</span><span class="w"> </span><span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n"><a class="reference internal" href="reference.html#imagingplus.workflows.AllOptical.AllOpticalTrial" title="imagingplus.workflows.AllOptical.AllOpticalTrial">imagingplus.workflows.AllOptical.AllOpticalTrial</a></span></em>, <em class="sig-param"><span class="n">pre_stim_sec</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">post_stim_sec</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">avg_only</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">x_label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_periphotostim_avg"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_periphotostim_avg">¶</a></dt>
<dd>
<p>plot trace across all stims
:param arr: Flu traces to plot (will be plotted as individual traces unless avg_only is True) dimensions should be cells x stims x key_frames
:param trialobj: instance object of AllOpticalTrial
:param pre_stim_sec: seconds of array to plot for pre-stim period
:param post_stim_sec: seconds of array to plot for post-stim period
:param title: title to use for plot
:param avg_only: if True, only plot the mean trace calculated from the traces provided in arr
:param x_label: x axis label
:param y_label: y axis label
:param kwargs:</p>
<blockquote>
<div><dl class="simple">
<dt>options include:</dt><dd><p>‘stim_duration’: photostimulation duration in secs
‘y_lims’: tuple, y min and max of the plot
‘edgecolor’: str, edgecolor of the individual traces behind the mean trace
‘savepath’: str, path to save plot to</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> – a matplotlib.Figure instance, if provided use this fig for plotting</p></li>
<li><p><strong>ax</strong> – a matplotlib.Axes.axes instance, if provided use this ax for plotting</p></li>
<li><p><strong>show</strong> – if False, do not display plot (used when the necessity is to return the fig and ax objects to futher manipulation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns fig, ax</dt>
<dd class="field-even"><p>returns fig and ax object, if show is False</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_SLMtargets_Locs">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_SLMtargets_Locs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trialobj</span><span class="p">:</span><span class="w"> </span><span class="n"><a class="reference internal" href="reference.html#imagingplus.workflows.AllOptical.AllOpticalTrial" title="imagingplus.workflows.AllOptical.AllOpticalTrial">imagingplus.workflows.AllOptical.AllOpticalTrial</a></span></em>, <em class="sig-param"><span class="n">targets_coords</span><span class="p">:</span><span class="w"> </span><span class="n">Union<span class="p">[</span>list<span class="p">,</span><span class="w"> </span>str<span class="p">]</span></span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">background</span><span class="p">:</span><span class="w"> </span><span class="n">numpy.ndarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_SLMtargets_Locs"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_SLMtargets_Locs">¶</a></dt>
<dd>
<p>plot SLM target coordinate locations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trialobj</strong> – </p></li>
<li><p><strong>targets_coords</strong> – ls containing (x,y) coordinates of targets to plot</p></li>
<li><p><strong>background</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
<li><p><strong>fig</strong> – a matplotlib.Figure instance, if provided use this fig for plotting</p></li>
<li><p><strong>ax</strong> – a matplotlib.Axes.axes instance, if provided use this ax for plotting</p></li>
<li><p><strong>show</strong> – if False, do not display plot (used when the necessity is to return the fig and ax objects to futher manipulation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns fig, ax</dt>
<dd class="field-even"><p>returns fig and ax object, if show is False</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.plot_s2pMasks">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">plot_s2pMasks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#plot_s2pMasks"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.plot_s2pMasks">¶</a></dt>
<dd>
<p>Creates some images of SLM targets to suite2p cells.</p>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="imagingplus.plotting.plotting.export_klicker_to_csv">
<code class="sig-prename descclassname">imagingplus.plotting.plotting.</code><code class="sig-name descname">export_klicker_to_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">klicker</span><span class="p">:</span><span class="w"> </span><span class="n">mpl_point_clicker._clicker.clicker</span></em>, <em class="sig-param"><span class="n">csv_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imagingplus/plotting/plotting.html#export_klicker_to_csv"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#imagingplus.plotting.plotting.export_klicker_to_csv">¶</a></dt>
<dd>
<p>Save point cellsdata from mplpointclicker klicker to .csv
:param klicker: mplpointclicker klicker object
:param csv_path: path to save csv file of klicker points</p>
</dd></dl>
</section>
</section>
</article>
<footer>
<div class="mt-20 mb-4 text-sm text-gray-700 print:mt-4">© 2022, Packer Lab Made with <a href="https://www.sphinx-doc.org">Sphinx 4.4.0</a></div>
</footer></main>
<button class="fixed bottom-0 right-0 z-20 opacity-0 p-4 m-4 tracking-wide bg-gray-900 text-gray-100 transition transform transform-gpu duration-500 translate-y-full" data-action="search#hideSnackbar" data-search-target="snackbar">
  Clear highlights
</button><div class="fixed hidden inset-0 bg-black bg-opacity-50" data-action="click-&gt;sidebar#close" data-sidebar-target="screen">
</div>
</div>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/doctools.js"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="_static/theme.3051a0ec24cad00d4d88.js"></script>
</body>
</html>